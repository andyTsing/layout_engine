<!doctype html>
<html>
  <head>
    
  </head>
  <body>
    <canvas id="canvas" width=1000 height=1000>
    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
      var canvas = document.getElementById('canvas');
      var ctx = canvas.getContext('2d');
      
      var socket = io();
      document.addEventListener("keypress", dokeypress, true );
      document.addEventListener("keydown", dokeydown, true );
      canvas.addEventListener("mousedown", domousedown );
      function domousedown(event) {
      console.log(event);
      socket.emit("mousedown event",{type: "mousedown", x: event.clientX, y: event.clientY});
      }

      function dokeydown(event) {
      console.log(event);
      if (event.keyCode == 8 && event.keyCode == 32 && event.target == document.body) {
      event.preventDefault();
      }
      socket.emit("keydown event", {type: "keydown", key: event.key,keyCode: event.keyCode});
      }

      function dokeypress(event) {
      console.log(event);
      if (event.keyCode == 8 && event.keyCode == 32 && event.target == document.body) {
      event.preventDefault();
      }

      socket.emit("keypress event", {type: "keypress", key : event.key, keycode : event.keycode});
      }


      socket.on("image", function(info) {
      if (info.image) {
      var img = new Image();
      img.src = 'data:image/png;base64,' + info.buffer.toString('base64');
      ctx.drawImage(img, 0, 0);
      }
      })
      
      socket.on("window size request", function() {
      console.log("window size requested");
      socket.emit("window size", { 'width':window.outerWidth, 'height':window.outerHeight});
      }
      );
    </script>
  </body>
</html>
